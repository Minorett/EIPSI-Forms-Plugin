/**
 * EIPSI Forms - Dark Mode Toggle
 * Universal semantic dark mode system with WCAG AAA compliance
 * 
 * @package EIPSI_Forms
 * @version 3.0.0
 */

/* ========================================
   DARK MODE COLOR SYSTEM
   ======================================== */

/**
 * Dark theme base colors
 * Applied when data-theme="dark" is set on <html>
 */
[data-theme="dark"] {
	--eipsi-bg: #0f172a;
	--eipsi-surface: #1e293b;
	--eipsi-text: #e2e8f0;
	--eipsi-border: #334155;
	--eipsi-text-muted: #cbd5e1;
}

/* Dark mode primary colors adapted per preset */
[data-theme="dark"][data-preset="clinical-blue"] {
	--eipsi-primary: #60a5fa;
	--eipsi-primary-hover: #3b82f6;
	--eipsi-background-subtle: #1e3a8a;
}

[data-theme="dark"][data-preset="serene-teal"] {
	--eipsi-primary: #5eead4;
	--eipsi-primary-hover: #2dd4bf;
	--eipsi-background-subtle: #164e63;
}

[data-theme="dark"][data-preset="warm-neutral"] {
	--eipsi-primary: #d4a574;
	--eipsi-primary-hover: #d97706;
	--eipsi-background-subtle: #5d4037;
}

[data-theme="dark"][data-preset="minimal-white"] {
	--eipsi-primary: #e2e8f0;
	--eipsi-primary-hover: #f1f5f9;
	--eipsi-background-subtle: #334155;
}

[data-theme="dark"][data-preset="dark-eipsi"] {
	/* Dark EIPSI already has dark theme colors, enhance them */
	--eipsi-primary: #22d3ee;
	--eipsi-primary-hover: #06b6d4;
	--eipsi-background-subtle: #003d5b;
}

/* ========================================
   SMOOTH TRANSITIONS
   ======================================== */

/**
 * Apply smooth transitions to all theme-aware elements
 * Improves perceived performance and UX
 */
.eipsi-form,
.eipsi-form * {
	transition:
		background-color 0.3s ease,
		border-color 0.3s ease,
		color 0.3s ease,
		box-shadow 0.3s ease;
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
	.eipsi-form,
	.eipsi-form * {
		transition-duration: 0.01ms !important;
	}
}

/* ========================================
   TOGGLE BUTTON STYLES
   ======================================== */

/**
 * Base toggle button
 * Used across header, footer, and mobile fixed position
 */
.eipsi-toggle {
	padding: 10px 16px;
	border-radius: 6px;
	border: 2px solid var(--eipsi-primary, #005a87);
	background: var(--eipsi-primary, #005a87);
	color: #ffffff;
	font-size: 13px;
	font-weight: 600;
	font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
	cursor: pointer;
	transition: all 0.3s ease;
	line-height: 1;
	white-space: nowrap;
}

/* Hover state */
.eipsi-toggle:hover {
	background: var(--eipsi-primary-hover, #003d5b);
	border-color: var(--eipsi-primary-hover, #003d5b);
	transform: translateY(-2px);
	box-shadow: 0 4px 12px rgba(0, 90, 135, 0.3);
}

/* Focus state - WCAG AAA */
.eipsi-toggle:focus-visible {
	outline: 3px solid var(--eipsi-primary, #005a87);
	outline-offset: 2px;
	box-shadow: 0 0 0 4px rgba(0, 90, 135, 0.2);
}

/* Active state */
.eipsi-toggle:active {
	transform: translateY(0);
}

/* Loading state */
.eipsi-toggle.eipsi-toggle--loading {
	opacity: 0.7;
	pointer-events: none;
	transform: scale(0.95);
}

/* Disabled state */
.eipsi-toggle:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* ========================================
   HEADER PLACEMENT
   ======================================== */

/**
 * Header container with toggle in top-right
 * Flexbox layout for responsive positioning
 */
.eipsi-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 20px;
	padding-bottom: 16px;
	border-bottom: 2px solid var(--eipsi-border, #64748b);
}

.eipsi-header h2 {
	color: var(--eipsi-text, #2c3e50);
	margin: 0;
	font-size: 1.5rem;
	font-weight: 600;
}

/* ========================================
   FOOTER PLACEMENT
   ======================================== */

/**
 * Footer toggle - centered below form
 * Provides secondary access point
 */
.eipsi-theme-toggle {
	display: flex;
	justify-content: center;
	margin-top: 24px;
	padding-top: 16px;
	border-top: 1px solid var(--eipsi-border, #64748b);
}

/* ========================================
   MOBILE FIXED TOGGLE
   ======================================== */

/**
 * Fixed position toggle for mobile devices
 * Bottom-right corner, accessible with thumb
 */
.eipsi-toggle-mobile {
	display: none;
	position: fixed;
	bottom: 20px;
	right: 20px;
	z-index: 999;
}

/* Show only on mobile */
@media (max-width: 768px) {
	.eipsi-toggle-mobile {
		display: flex;
	}
}

.eipsi-toggle-mobile .eipsi-toggle {
	width: 48px;
	height: 48px;
	padding: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 20px;
	border-radius: 50%;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

/* Enhanced focus for mobile */
.eipsi-toggle-mobile .eipsi-toggle:focus-visible {
	outline: 4px solid var(--eipsi-primary, #005a87);
	outline-offset: 3px;
}

/* ========================================
   NOSCRIPT FALLBACK
   ======================================== */

/**
 * Hide toggles when JavaScript is disabled
 * Graceful degradation for accessibility
 */
noscript .eipsi-theme-toggle,
noscript .eipsi-toggle-mobile {
	display: none !important;
}

/* ========================================
   RESPONSIVE ADJUSTMENTS
   ======================================== */

/* Tablet adjustments */
@media (max-width: 1024px) {
	.eipsi-header {
		padding-bottom: 12px;
	}

	.eipsi-header h2 {
		font-size: 1.35rem;
	}

	.eipsi-toggle {
		padding: 8px 14px;
		font-size: 12px;
	}
}

/* Mobile adjustments */
@media (max-width: 768px) {
	.eipsi-header {
		flex-direction: column;
		align-items: flex-start;
		gap: 12px;
	}

	.eipsi-header h2 {
		font-size: 1.25rem;
	}

	/* Hide header and footer toggles on mobile (use fixed instead) */
	.eipsi-header .eipsi-toggle,
	.eipsi-theme-toggle {
		display: none;
	}
}

/* Small mobile adjustments */
@media (max-width: 480px) {
	.eipsi-toggle-mobile {
		bottom: 16px;
		right: 16px;
	}

	.eipsi-toggle-mobile .eipsi-toggle {
		width: 44px;
		height: 44px;
		font-size: 18px;
	}
}

/* ========================================
   HIGH CONTRAST MODE SUPPORT
   ======================================== */

/**
 * Enhance visibility in Windows High Contrast Mode
 * System-level accessibility feature
 */
@media (prefers-contrast: high) {
	.eipsi-toggle {
		border-width: 3px;
		font-weight: 700;
	}

	.eipsi-header {
		border-bottom-width: 3px;
	}

	.eipsi-theme-toggle {
		border-top-width: 3px;
	}
}

/* ========================================
   PRINT STYLES
   ======================================== */

/**
 * Hide toggle controls in print
 */
@media print {
	.eipsi-toggle,
	.eipsi-toggle-mobile,
	.eipsi-theme-toggle {
		display: none !important;
	}
}
