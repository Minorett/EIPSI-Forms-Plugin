<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Controls Test - EIPSI Forms</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #005a87;
            border-bottom: 2px solid #005a87;
            padding-bottom: 10px;
        }
        
        .eipsi-page {
            display: none;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        .eipsi-page.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input[type="text"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .form-navigation {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .eipsi-prev-button {
            background: #6c757d;
            color: white;
        }
        
        .eipsi-prev-button:hover {
            background: #5a6268;
        }
        
        .eipsi-next-button {
            background: #005a87;
            color: white;
        }
        
        .eipsi-next-button:hover {
            background: #003d5b;
        }
        
        .eipsi-submit-button {
            background: #198754;
            color: white;
        }
        
        .eipsi-submit-button:hover {
            background: #157347;
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .form-progress {
            text-align: center;
            margin-bottom: 20px;
            color: #64748b;
            font-size: 14px;
        }
        
        .test-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #005a87;
        }
        
        .test-info p {
            margin: 5px 0;
        }
        
        .radio-list {
            list-style: none;
            padding: 0;
        }
        
        .radio-list li {
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        
        .radio-list li:hover {
            background: #f8f9fa;
        }
        
        .radio-list input[type="radio"] {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª Navigation Controls Test Suite</h1>
    
    <!-- Test 1: Multi-page with backwards enabled -->
    <div class="test-section">
        <h2>Test 1: Multi-page Form (Backwards Enabled)</h2>
        <div class="test-info">
            <p><strong>Expected behavior:</strong></p>
            <ul>
                <li>âœ… Prev button hidden on page 1</li>
                <li>âœ… Prev button appears on page 2+</li>
                <li>âœ… Next button visible until last page</li>
                <li>âœ… Submit button only on last page</li>
                <li>âœ… No double-clicking during submission</li>
            </ul>
        </div>
        
        <div class="vas-dinamico-form">
            <form id="test-form-1">
                <input type="hidden" name="form_id" value="test-1">
                <input type="hidden" class="eipsi-current-page" value="1">
                <input type="hidden" class="eipsi-start-time" value="">
                
                <div class="form-progress">
                    Page <span class="current-page">1</span> of <span class="total-pages">3</span>
                </div>
                
                <!-- Page 1 -->
                <div class="eipsi-page active" data-page="1">
                    <h3>Page 1</h3>
                    <div class="form-group" data-required="true">
                        <label for="name-1">Name</label>
                        <input type="text" id="name-1" name="name" required>
                    </div>
                </div>
                
                <!-- Page 2 -->
                <div class="eipsi-page" data-page="2">
                    <h3>Page 2</h3>
                    <div class="form-group" data-required="true">
                        <label for="email-1">Email</label>
                        <input type="email" id="email-1" name="email" required>
                    </div>
                </div>
                
                <!-- Page 3 -->
                <div class="eipsi-page" data-page="3">
                    <h3>Page 3</h3>
                    <div class="form-group">
                        <label for="comments-1">Comments</label>
                        <input type="text" id="comments-1" name="comments">
                    </div>
                </div>
                
                <div class="form-navigation">
                    <div class="form-nav-left">
                        <button type="button" class="eipsi-prev-button" style="display: none;">Previous</button>
                    </div>
                    <div class="form-nav-right">
                        <button type="button" class="eipsi-next-button">Next</button>
                        <button type="submit" class="eipsi-submit-button" style="display: none;">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Test 2: Backwards disabled -->
    <div class="test-section">
        <h2>Test 2: Multi-page Form (Backwards Disabled)</h2>
        <div class="test-info">
            <p><strong>Expected behavior:</strong></p>
            <ul>
                <li>âœ… Prev button ALWAYS hidden (even on page 2+)</li>
                <li>âœ… Next/Submit buttons work normally</li>
            </ul>
        </div>
        
        <div class="vas-dinamico-form">
            <form id="test-form-2" data-allow-backwards-nav="false">
                <input type="hidden" name="form_id" value="test-2">
                <input type="hidden" class="eipsi-current-page" value="1">
                <input type="hidden" class="eipsi-start-time" value="">
                
                <div class="form-progress">
                    Page <span class="current-page">1</span> of <span class="total-pages">3</span>
                </div>
                
                <!-- Page 1 -->
                <div class="eipsi-page active" data-page="1">
                    <h3>Page 1</h3>
                    <div class="form-group">
                        <label for="name-2">Name</label>
                        <input type="text" id="name-2" name="name">
                    </div>
                </div>
                
                <!-- Page 2 -->
                <div class="eipsi-page" data-page="2">
                    <h3>Page 2</h3>
                    <div class="form-group">
                        <label for="email-2">Email</label>
                        <input type="email" id="email-2" name="email">
                    </div>
                </div>
                
                <!-- Page 3 -->
                <div class="eipsi-page" data-page="3">
                    <h3>Page 3</h3>
                    <div class="form-group">
                        <label for="comments-2">Comments</label>
                        <input type="text" id="comments-2" name="comments">
                    </div>
                </div>
                
                <div class="form-navigation">
                    <div class="form-nav-left">
                        <button type="button" class="eipsi-prev-button" style="display: none;">Previous</button>
                    </div>
                    <div class="form-nav-right">
                        <button type="button" class="eipsi-next-button">Next</button>
                        <button type="submit" class="eipsi-submit-button" style="display: none;">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Test 3: Branch jump with conditional logic -->
    <div class="test-section">
        <h2>Test 3: Branch Jump (Skip Pages)</h2>
        <div class="test-info">
            <p><strong>Expected behavior:</strong></p>
            <ul>
                <li>âœ… Select "Jump to page 4" to skip pages 2-3</li>
                <li>âœ… Prev button returns to page 1 (not page 3)</li>
                <li>âœ… Submit appears on page 4</li>
            </ul>
        </div>
        
        <div class="vas-dinamico-form">
            <form id="test-form-3">
                <input type="hidden" name="form_id" value="test-3">
                <input type="hidden" class="eipsi-current-page" value="1">
                <input type="hidden" class="eipsi-start-time" value="">
                
                <div class="form-progress">
                    Page <span class="current-page">1</span> of <span class="total-pages">4</span>
                </div>
                
                <!-- Page 1 with conditional -->
                <div class="eipsi-page active" data-page="1">
                    <h3>Page 1</h3>
                    <div class="form-group" data-field-type="radio" data-conditional-logic='{"enabled":true,"rules":[{"id":"rule1","matchValue":"jump","action":"goToPage","targetPage":"4"}],"defaultAction":"nextPage"}'>
                        <label>Navigation choice:</label>
                        <ul class="radio-list">
                            <li>
                                <input type="radio" id="next-3" name="nav_choice" value="next">
                                <label for="next-3">Go to next page</label>
                            </li>
                            <li>
                                <input type="radio" id="jump-3" name="nav_choice" value="jump">
                                <label for="jump-3">Jump to page 4</label>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- Page 2 -->
                <div class="eipsi-page" data-page="2">
                    <h3>Page 2 (Skippable)</h3>
                    <div class="form-group">
                        <label for="field-2">Field 2</label>
                        <input type="text" id="field-2" name="field2">
                    </div>
                </div>
                
                <!-- Page 3 -->
                <div class="eipsi-page" data-page="3">
                    <h3>Page 3 (Skippable)</h3>
                    <div class="form-group">
                        <label for="field-3">Field 3</label>
                        <input type="text" id="field-3" name="field3">
                    </div>
                </div>
                
                <!-- Page 4 -->
                <div class="eipsi-page" data-page="4">
                    <h3>Page 4 (Final)</h3>
                    <div class="form-group">
                        <label for="field-4">Final field</label>
                        <input type="text" id="field-4" name="field4">
                    </div>
                </div>
                
                <div class="form-navigation">
                    <div class="form-nav-left">
                        <button type="button" class="eipsi-prev-button" style="display: none;">Previous</button>
                    </div>
                    <div class="form-nav-right">
                        <button type="button" class="eipsi-next-button">Next</button>
                        <button type="submit" class="eipsi-submit-button" style="display: none;">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Test 4: Auto-submit rule -->
    <div class="test-section">
        <h2>Test 4: Auto-submit Rule</h2>
        <div class="test-info">
            <p><strong>Expected behavior:</strong></p>
            <ul>
                <li>âœ… Select "Submit now" on page 1</li>
                <li>âœ… Next button disappears, Submit button appears</li>
                <li>âœ… Form submits when clicking Submit</li>
            </ul>
        </div>
        
        <div class="vas-dinamico-form">
            <form id="test-form-4">
                <input type="hidden" name="form_id" value="test-4">
                <input type="hidden" class="eipsi-current-page" value="1">
                <input type="hidden" class="eipsi-start-time" value="">
                
                <div class="form-progress">
                    Page <span class="current-page">1</span> of <span class="total-pages">2</span>
                </div>
                
                <!-- Page 1 with auto-submit -->
                <div class="eipsi-page active" data-page="1">
                    <h3>Page 1</h3>
                    <div class="form-group" data-field-type="radio" data-conditional-logic='{"enabled":true,"rules":[{"id":"rule1","matchValue":"submit","action":"submit"}],"defaultAction":"nextPage"}'>
                        <label>Choose action:</label>
                        <ul class="radio-list">
                            <li>
                                <input type="radio" id="continue-4" name="action_choice" value="continue">
                                <label for="continue-4">Continue to page 2</label>
                            </li>
                            <li>
                                <input type="radio" id="submit-4" name="action_choice" value="submit">
                                <label for="submit-4">Submit now</label>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- Page 2 -->
                <div class="eipsi-page" data-page="2">
                    <h3>Page 2</h3>
                    <div class="form-group">
                        <label for="final-field">Final field</label>
                        <input type="text" id="final-field" name="final_field">
                    </div>
                </div>
                
                <div class="form-navigation">
                    <div class="form-nav-left">
                        <button type="button" class="eipsi-prev-button" style="display: none;">Previous</button>
                    </div>
                    <div class="form-nav-right">
                        <button type="button" class="eipsi-next-button">Next</button>
                        <button type="submit" class="eipsi-submit-button" style="display: none;">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Mock EIPSI Forms config
        window.eipsiFormsConfig = {
            ajaxUrl: '#',
            nonce: 'test-nonce',
            strings: {
                submit: 'Submit',
                requiredField: 'This field is required.'
            },
            settings: {
                validateOnBlur: false,
                enableAutoScroll: false,
                debug: true
            }
        };
        
        // Mock tracking
        window.EIPSITracking = {
            registerForm: function() {},
            setTotalPages: function() {},
            setCurrentPage: function() {},
            recordPageChange: function() {},
            recordSubmit: function() {},
            trackEvent: function() {}
        };
    </script>
    
    <script src="assets/js/eipsi-forms.js"></script>
    
    <script>
        // Initialize after forms.js loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Test page loaded');
            console.log('ðŸ“‹ Test scenarios:');
            console.log('  1. Multi-page with backwards navigation');
            console.log('  2. Backwards navigation disabled');
            console.log('  3. Branch jumps (skip pages)');
            console.log('  4. Auto-submit rules');
        });
    </script>
</body>
</html>
